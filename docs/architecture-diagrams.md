# System Architecture Diagrams

## High-Level System Flow

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          Excel to YAML Semantic Utility                         │
└─────────────────────────────────────────────────────────────────────────────────┘

┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│                 │    │                 │    │                 │    │                 │
│   Excel Input   │───▶│ Data Processing │───▶│ Schema Building │───▶│  YAML Output    │
│   (.xlsx)       │    │    Pipeline     │    │    Pipeline     │    │   (.yml)        │
│                 │    │                 │    │                 │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
        │                        │                        │                        │
        ▼                        ▼                        ▼                        ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ • Cubes         │    │ • Sheet         │    │ • Cube          │    │ • Structured    │
│ • Joins         │    │   Detection     │    │   Definitions   │    │   YAML Schema   │
│ • Dimensions    │    │ • Column        │    │ • Join          │    │ • BI Ready      │
│ • Measures      │    │   Mapping       │    │   Relationships │    │ • Version       │
│                 │    │ • Data Cleaning │    │ • Dimension     │    │   Controlled    │
│                 │    │ • Validation    │    │   Specs         │    │                 │
│                 │    │                 │    │ • Measure Defs  │    │                 │
└─────────────────┘    └─────────────────┘    └─────────────────┘    └─────────────────┘
```

## Component Architecture

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              APPLICATION LAYER                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                 │
│  │   CLI Parser    │  │  Configuration  │  │  Error Handler  │                 │
│  │   (argparse)    │  │   Management    │  │   & Logging     │                 │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                 │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                             BUSINESS LOGIC LAYER                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                 │
│  │ Sheet Detection │  │ Schema Builder  │  │ YAML Generator  │                 │
│  │ & Scoring       │  │ (Cubes, Joins,  │  │ & Formatter     │                 │
│  │                 │  │ Dims, Measures) │  │                 │                 │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                 │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                            DATA PROCESSING LAYER                                │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                 │
│  │ Data Cleaning   │  │ Column Mapping  │  │ Type Conversion │                 │
│  │ & Normalization │  │ & Aliasing      │  │ & Validation    │                 │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                 │
│                                                                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                               DATA ACCESS LAYER                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                 │
│  │ Excel Reader    │  │ DataFrame       │  │ YAML Writer     │                 │
│  │ (openpyxl)      │  │ Processing      │  │ (PyYAML)        │                 │
│  │                 │  │ (pandas)        │  │                 │                 │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                 │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## Data Flow Diagram

```
┌─────────────────┐
│ Excel File      │
│ (.xlsx)         │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐
│ File Validation │
│ & Loading       │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Sheet 1         │    │ Sheet 2         │    │ Sheet 3         │    │ Sheet N         │
│ Processing      │    │ Processing      │    │ Processing      │    │ Processing      │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │                      │
          ▼                      ▼                      ▼                      ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Column          │    │ Column          │    │ Column          │    │ Column          │
│ Normalization   │    │ Normalization   │    │ Normalization   │    │ Normalization   │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │                      │
          ▼                      ▼                      ▼                      ▼
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│ Sheet Type      │    │ Sheet Type      │    │ Sheet Type      │    │ Sheet Type      │
│ Detection       │    │ Detection       │    │ Detection       │    │ Detection       │
└─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘    └─────────┬───────┘
          │                      │                      │                      │
          └──────────────────────┼──────────────────────┼──────────────────────┘
                                 │                      │
                                 ▼                      ▼
                       ┌─────────────────┐    ┌─────────────────┐
                       │ Cubes           │    │ Joins           │
                       │ Processing      │    │ Processing      │
                       └─────────┬───────┘    └─────────┬───────┘
                                 │                      │
                                 ▼                      ▼
                       ┌─────────────────┐    ┌─────────────────┐
                       │ Dimensions      │    │ Measures        │
                       │ Processing      │    │ Processing      │
                       └─────────┬───────┘    └─────────┬───────┘
                                 │                      │
                                 └──────────┬───────────┘
                                            │
                                            ▼
                                  ┌─────────────────┐
                                  │ Schema          │
                                  │ Consolidation   │
                                  └─────────┬───────┘
                                            │
                                            ▼
                                  ┌─────────────────┐
                                  │ YAML            │
                                  │ Generation      │
                                  └─────────┬───────┘
                                            │
                                            ▼
                                  ┌─────────────────┐
                                  │ Output File     │
                                  │ (.yml)          │
                                  └─────────────────┘
```

## Processing Pipeline Stages

```
Stage 1: Input Processing
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  Excel File ──▶ Validation ──▶ Sheet Discovery ──▶ Data Load   │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

Stage 2: Data Cleaning
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  Raw Data ──▶ Empty Removal ──▶ Normalization ──▶ Cleaning     │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

Stage 3: Sheet Classification
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  Clean Data ──▶ Column Mapping ──▶ Scoring ──▶ Classification  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

Stage 4: Schema Building
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  Classified Data ──▶ Type Processing ──▶ Relationship Building │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘

Stage 5: Output Generation
┌─────────────────────────────────────────────────────────────────┐
│                                                                 │
│  Schema Objects ──▶ YAML Serialization ──▶ File Writing        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

## Error Handling Flow

```
┌─────────────────┐
│ Input Stage     │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐    YES    ┌─────────────────┐
│ File Exists?    │──────────▶│ Continue        │
└─────────┬───────┘           └─────────────────┘
          │ NO
          ▼
┌─────────────────┐
│ Exit with Error │
└─────────────────┘

┌─────────────────┐
│ Processing      │
│ Stage           │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐    YES    ┌─────────────────┐
│ Valid Sheets    │──────────▶│ Continue        │
│ Found?          │           │ Processing      │
└─────────┬───────┘           └─────────────────┘
          │ NO
          ▼
┌─────────────────┐
│ Exit with       │
│ Warning Message │
└─────────────────┘

┌─────────────────┐
│ Output Stage    │
└─────────┬───────┘
          │
          ▼
┌─────────────────┐    YES    ┌─────────────────┐
│ Can Write       │──────────▶│ Generate YAML   │
│ Output?         │           │ File            │
└─────────┬───────┘           └─────────────────┘
          │ NO
          ▼
┌─────────────────┐
│ Exit with       │
│ Permission Error│
└─────────────────┘
```